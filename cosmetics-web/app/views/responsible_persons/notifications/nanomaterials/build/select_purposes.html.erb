<%
  title = "Select nanomaterial purpose"
  question = "What is the purpose of this nanomaterial?"
  items = NanoElementPurposes.all.map do |purpose|
    { key: purpose.name,
      text: purpose.display_name.upcase_first,
      checked: @nano_element.purposes&.include?(purpose.name),
      disable_ghost: true }
  end
%>

<% page_title title, errors: @nano_element.errors.messages.include?(:purposes) %>
<% content_for :after_header do %>
  <%= govukBackLink text: "Back", href: previous_wizard_path %>
<% end %>

<%= form_with(model: @nano_element, url: wizard_path, method: :put) do |form| %>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      <% if @nano_element.errors.messages.include?(:purposes) %>
        <%= govukErrorSummary(titleText: "There is a problem", errorList: [{text: @nano_element.errors.messages[:purposes][0], href: "#nano_element_colorant"}] ) %>
      <% end %>
      <%= govukCheckboxes(
            form: form,
            key: :purposes,
            fieldset: { legend: { text: question, classes: "govuk-label--l", isPageHeading: true } },
            items: items,
          ) %>
      <%= govukButton text: "Continue" %>

    </div>
  </div>
<% end %>
<%#
  <%= govukRadios(
        form: form,
        key: :purposes,
        fieldset: { legend: { text: question,
                              classes: "govuk-label--l",
                              isPageHeading: true } },
        items: [{ text: "Yes", value: "true" },
                { text: "No", value: "false" }]
      ) %>