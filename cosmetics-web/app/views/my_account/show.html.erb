<% title = "Your account" %>
<% page_title title %>
<% content_for :after_header do %>
  <%= render "layouts/navbar" if submit_domain? %>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-full">
      <%= govuk_back_link(href: request.referer) %>
    </div>
  </div>
<% end %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">

    <h1 class="govuk-heading-l"><%= title %></h1>
    <% if submit_domain? %>
      <%= govuk_summary_list do |summary_list|
        summary_list.with_row do |row|
          row.with_key { 'Full name' }
          row.with_value { current_user.name }
          row.with_action(text: "Change", href: edit_my_account_name_path, visually_hidden_text: 'name')

        end; summary_list.with_row do |row|
          row.with_key(text: 'Email address')
          row.with_value(text: current_user.email)
          row.with_action(text: "Change", href: edit_my_account_email_path, visually_hidden_text: "email address")

        end; summary_list.with_row do |row|
          row.with_key(text: 'Password')
          row.with_value(text: "********")
          row.with_action(text: 'Change', href: edit_my_account_password_path, visually_hidden_text: 'password')

        end; end %>
    <% end %>

    <% if support_domain? %>
      <%= govuk_summary_list do |summary_list|
        summary_list.with_row do |row|
          row.with_key { 'Full name' }
          row.with_value { current_user.name }
          row.with_action(text: "Change", href: edit_my_account_name_path, visually_hidden_text: 'name')

        end; summary_list.with_row do |row|
          row.with_key(text: 'Email address')
          row.with_value(text: current_user.email)
          row.with_action(text: "Change", href: edit_my_account_email_path, visually_hidden_text: "email address")

        end; summary_list.with_row do |row|
          row.with_key(text: 'Password')
          row.with_value(text: "********")
          row.with_action(text: 'Change', href: edit_my_account_password_path, visually_hidden_text: 'password')

        end; end %>
    <% end %>

    <% if search_domain? %>
      <%= govuk_summary_list do |summary_list|
        summary_list.with_row do |row|
          row.with_key { 'Full name' }
          row.with_value { current_user.name }
          row.with_action(text: "Change", href: edit_my_account_name_path, visually_hidden_text: 'name')

        end; summary_list.with_row do |row|
          row.with_key(text: 'Email address')
          row.with_value(text: current_user.email)

        end; summary_list.with_row do |row|
          row.with_key(text: 'Mobile number')
          row.with_value(text: current_user.mobile_number)

        end; summary_list.with_row do |row|
          row.with_key(text: 'Password')
          row.with_value(text: "********")
          row.with_action(text: 'Change', href: edit_my_account_password_path, visually_hidden_text: 'password')

        end; end %>
    <% end %>

    <h2 class="govuk-heading-l">Your security preferences</h2>
    <p class="govuk-body opss-secondary-text">This is how you get access codes</p>
    <%= govuk_summary_list do |summary_list|
      summary_list.with_row do |row|
        row.with_key { 'Text message' }
        row.with_value { current_user.mobile_number }
        row.with_action(text: current_user.sms_authentication_set? ? "Change" : "Add", href: new_secondary_authentication_sms_setup_path, visually_hidden_text: "text message")

      end; summary_list.with_row do |row|
        row.with_key(text: 'Authenticator app')
        row.with_value(text: ("Authenticator app is set" if current_user.app_authentication_set?))
        row.with_action(text: current_user.app_authentication_set? ? "Change" : "Add", href: new_secondary_authentication_app_setup_path, visually_hidden_text: "authenticator app")

      end; summary_list.with_row do |row|
        row.with_key(text: 'Recovery codes')
        row.with_value(text: "")
        row.with_action(text: "View", href: new_secondary_authentication_recovery_codes_setup_path(back_to: "my_account"), visually_hidden_text: "recovery codes")

      end; end %>

    <% if support_domain? %>
      <h2 class="govuk-heading-l">User management</h2>
      <%= govuk_summary_list do |summary_list|
        summary_list.with_row do |row|
          row.with_key { 'Add a team member' }
          row.with_value { "" }
          row.with_action(text: "Invite", href: support_portal.new_invite_support_user_path, visually_hidden_text: "invite team member")

        end; summary_list.with_row do |row|
          row.with_key(text: "Remove team member")
          row.with_value(text: "")
          row.with_action(text: "View team members", href: new_secondary_authentication_app_setup_path, visually_hidden_text: "View team members")

        end; end %>
      <%= govuk_button_link_to("Go to Cosmetic products search", main_app.new_support_on_search_user_session_url(host: ENV['SEARCH_HOST']), secondary: true, target: "_blank") %>
    <% end %>

    <% if search_domain? && current_user.opss_science_user? %>
      <%= render "opss_science_downloads" %>
    <% end %>
  </div>
</div>
