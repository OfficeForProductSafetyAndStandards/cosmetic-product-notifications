<% title = "Your account" %>
<% page_title title %>
<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">

    <h1 class="govuk-heading-l"><%= title %></h1>

    <% if submit_domain? %>
      <%= govukSummaryList(
        classes: "app-summary-list--key-weight-regular",
        rows: [
          {
            key: { text: "Full name" },
            value: { text: current_user.name },
            actions: {
              items: [
                {
                  href: edit_my_account_name_path,
                  text: "Change",
                  visuallyHiddenText: "name"
                }
              ]
            }
          },
          {
            key: { text: "Email address" },
            value: { text: current_user.email },
            actions: {
              items: [
                {
                  href: edit_my_account_email_path,
                  text: "Change",
                  visuallyHiddenText: "email address"
                }
              ]
            }
          },
          {
            key: { text: "Password" },
            value: { text: "********" },
            actions: {
              items: [
                {
                  href: edit_my_account_password_path,
                  text: "Change",
                  visuallyHiddenText: "password"
                }
              ]
            }
          }
        ]
      ) %>
    <% else %>
      <%= govukSummaryList(
        classes: "app-summary-list--key-weight-regular",
        rows: [
          {
            key: { text: "Full name" },
            value: { text: current_user.name },
            actions: {
              items: [
                {
                  href: edit_my_account_name_path,
                  text: "Change",
                  visuallyHiddenText: "name"
                }
              ]
            }
          },
          {
            key: { text: "Email address" },
            value: { text: current_user.email },
          },
          {
            key: { text: "Mobile number" },
            value: { text: current_user.mobile_number },
          },
          {
            key: { text: "Password" },
            value: { text: "********" },
            actions: {
              items: [
                {
                  href: edit_my_account_password_path,
                  text: "Change",
                  visuallyHiddenText: "password"
                }
              ]
            }
          }
        ]
      ) %>
    <% end %>

    <h2 class="govuk-heading-l">Your security preferences</h2>
    <p class="govuk-body">This is how you get access codes.</p>
      <%= govukSummaryList(
        classes: "app-summary-list--key-weight-regular",
        rows: [
          {
            key: { text: "Text message" },
            value: { text: current_user.mobile_number },
            actions: {
              items: [
                {
                  href: new_secondary_authentication_sms_setup_path,
                  text: current_user.sms_authentication_set? ? "Change" : "Add",
                  visuallyHiddenText: "text message"
                }
              ]
            }
          },
          {
            key: { text: "Authenticator app" },
            value: { text: ("Authenticator app is set" if current_user.app_authentication_set?) },
            actions: {
              items: [
                {
                  href: new_secondary_authentication_app_setup_path,
                  text: current_user.app_authentication_set? ? "Change" : "Add",
                  visuallyHiddenText: "authenticator app"
                }
              ]
            }
          },
        ]
      ) %>

    <% if search_domain? && current_user.opss_science_user? %>
      <h2 class="govuk-heading-l">Downloadable data</h2>
      <p class="govuk-body">
        Your account privileges allow you to download this information directly to your computer or device. <br class="opss-br-desktop">
        (Downloadable data is updated at midnight).
      </p>
      <%= govukSummaryList(
        classes: "app-summary-list--key-weight-regular",
        rows: [
          {
            key: { text: "All notified cosmetic products containing nanomaterials" },
            value: { html: "Download as a <abbr>CSV</abbr> (spreadsheet) file".html_safe },
            actions: {
              items: [
                {
                  href: ActiveStorage::Blob.find_by(filename: UploadCosmeticProductsContainingNanomaterialsJob.file_name)&.url,
                  html: "<span class='opss-download-link-sm'></span>Download".html_safe,
                  visuallyHiddenText: "products with nanomaterials",
                  classes: "govuk-link--no-visited-state",
                }
              ]
            }
          },
          {
            key: { text: "All notified nanomaterials" },
            value: { html: "Download as a <abbr>CSV</abbr> (spreadsheet) file".html_safe },
            actions: {
              items: [
                {
                  href: ActiveStorage::Blob.find_by(filename: UploadNanomaterialNotificationsJob.file_name)&.url,
                  html: "<span class='opss-download-link-sm'></span>Download".html_safe,
                  visuallyHiddenText: "notified nanomaterials",
                  classes: "govuk-link--no-visited-state",
                }
              ]
            }
          },
          {
            key: { html: "All notified nanomaterials as <abbr>PDF</abbr>s".html_safe },
            value: { html: "Download as a ZIP file (containing <abbr>PDF</abbr>s)".html_safe },
            actions: {
              items: [
                {
                  href: ActiveStorage::Blob.find_by(filename: UploadNanomaterialsPdfsJob.file_name)&.url,
                  html: "<span class='opss-download-link-sm'></span>Download".html_safe,
                  visuallyHiddenText: "notified nanomaterials as <abbr>PDF</abbr>s".html_safe,
                  classes: "govuk-link--no-visited-state",
                }
              ]
            }
          },
        ]
      ) %>
    <% end %>
  </div>
</div>
